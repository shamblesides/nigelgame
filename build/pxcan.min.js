"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},pxcan=function t(e){function n(t,e){"function"==typeof e?Object.defineProperty(p,t,{get:e}):Object.defineProperty(p,t,e)}function i(t,e){R.width=(v=Math.floor(t/x))*x,R.height=(y=Math.floor(e/x))*x}function r(t,e){R.width!==v*x&&(R.width=v*x),R.height!==y*x&&(R.height=y*x)}function o(t,e){m.minWidth*e==m.minHeight*t?(v=m.minWidth,y=m.minHeight):m.minWidth*e<m.minHeight*t?(v=Math.floor(t/e*m.minHeight),y=m.minHeight):(v=m.minWidth,y=Math.floor(e/t*m.minWidth)),x=Math.floor(Math.min(e/y,t/v)),x<1&&(x=1),R.width=v*x,R.height=y*x}function a(){++j,j>p.frameskip&&(j=0,p.fitElement(),p.onFrame&&!p.isPreloading&&p.onFrame.call(p,p),s(),g(),++D),B(a)}function h(t){if(void 0===C[t.keyCode])return!0;t.preventDefault();var e=I[C[t.keyCode]];"keydown"===t.type&&0===e.framesDown?(e.wasPressed=e.isDown=!0,e.framesDown=0):"keyup"===t.type&&e.isDown&&(e.wasReleased=!0,e.isDown=!1)}function s(){for(var t in I)I[t].wasPressed&&(I[t].wasPressed=!1),I[t].wasReleased&&(I[t].wasReleased=!1),I[t].isDown?++I[t].framesDown:I[t].framesDown=0}function c(t){var n=t.clientX-(e.clientLeft||0)-(e.offsetLeft||0)+window.scrollX,i=t.clientY-(e.clientTop||0)-(e.offsetTop||0)+window.scrollY;return{fromLeft:Math.floor(n/(e.clientWidth||e.innerWidth)*p.width),fromTop:Math.floor(i/(e.clientHeight||e.innerHeight)*p.height)}}function f(t,e,n,i){n=n||p,i=i||!1,Object.defineProperty(this,"x",{get:function(){return(i?pxMath.clamp(t,n.canvasOffX+0,n.canvasOffX+n.width-1):t)+n.left-n.canvasOffX}}),Object.defineProperty(this,"y",{get:function(){return(i?pxMath.clamp(e,n.canvasOffY+0,n.canvasOffY+n.height-1):e)+n.top-n.canvasOffY}}),Object.defineProperty(this,"inBounds",{get:function(){return i||this.x===this.bounded().x&&this.y===this.bounded().y}}),this.rel=function(n,i){if(-1===["bounded","b","unbounded","u",void 0].indexOf(i))throw new Error('bad value for "bounded" parameter.');return new f(t,e,n,i&&i.startsWith("b"))},function(t){t.bounded=function(){return t.rel(n,"bounded")},t.unbounded=function(){return t.rel(n,"unbounded")}}(this)}function d(t,e){M.cur=M.last=M.start=new f(t,e),M.changed=!0,M.isDown=!0,M.wasStarted=!0}function l(t,e){M.cur=new f(t,e),M.x===M.last.x&&M.y===M.last.y||(M.changed=!0,M.moved=!0,M.isDrag=!0)}function u(){M.changed=!0,M.isDown=!1,M.wasReleased=!0}function g(){M.changed=!1,M.wasStarted=!1,M.moved=!1,M.wasReleased=!1,M.wasInterrupted=!1,M.isDown?M.last=M.cur:(M.cur=M.last=M.start=void 0,M.isMouse=void 0,M.isRightClick=void 0,M.isDrag=!1)}var w=this,p=this;"string"==typeof(e=e||window)&&(e=document.querySelector(e));var m={name:"adapt"},v=e.clientWidth||e.innerWidth,y=e.clientHeight||e.innerWidth,x=3,b=!0,A=null,S="px8",O={},P={x:0,y:0},E={x:0,y:0},C={},I={},M={changed:!1,isDown:!1,isMouse:void 0,isRightClick:void 0,wasStarted:!1,moved:!1,isDrag:!1,wasReleased:!1,wasInterrupted:!1,cur:void 0,last:void 0,start:void 0,x:null,y:null,inBounds:null,rel:null,bounded:null,unbounded:null},j=0,D=0,R=document.createElement("canvas");R.style.display="block",R.style.margin="auto";var H=R.getContext("2d");if(e==window){var T=document.querySelector("body");T.style.padding=0,T.style.margin=0,T.style.overflow="hidden"}(e!==window?e:document.getElementsByTagName("body")[0]).appendChild(R),e!==window&&e.tabIndex<0&&(e.tabIndex=0),n("id",{value:t.assignId(this)}),n("element",function(){return e}),n("canvas",function(){return R}),n("context",function(){return H}),n("canvasOffX",function(){return 0}),n("canvasOffY",function(){return 0}),n("left",function(){return Math.round(-E.x-v*(P.x+1)/2)}),n("top",function(){return Math.round(-E.y-y*(P.y+1)/2)}),n("right",function(){return w.left+v-1}),n("bottom",function(){return w.top+y-1}),n("width",function(){return v}),n("height",function(){return y}),n("drawScale",function(){return x}),n("wasResized",function(){return b}),n("clock",function(){return D}),n("frameskip",{value:0,writable:!0}),this.origin=function(t,e){if(0===arguments.length)return{x:P.x,y:P.y};if(2!==arguments.length)throw new Error("invalid arguments for origin");P={x:t,y:e}},this.offset=function(t,e){if(0===arguments.length)return{x:E.x,y:E.y};if(2!==arguments.length)throw new Error("invalid arguments for offset");E={x:t,y:e}},n("font",{set:function(t){if(!this.hasSheet(t))throw new Error("invalid font: "+t);S=t},get:function(){if(!S)throw new Error("font has not been set.");return S}}),this.mode=function(t){if(0===arguments.length)return m.name;if("adapt"===t)m={name:"adapt"},x=arguments[1]||1,R.style.width="",R.style.height="";else if("fixed"===t)m={name:"fixed"},arguments.length<=2?(x=arguments[1]||1,v=Math.floor((e.clientWidth||e.innerWidth)/x),y=Math.floor((e.clientHeight||e.innerHeight)/x)):(v=arguments[1],y=arguments[2],x=arguments[3]||1),R.style.width="",R.style.height="";else{if("scale-overflow"!==t)throw"scale"===t?new Error("not yet supported."):new Error("unknown mode type.");m={name:"scale-overflow",minWidth:arguments[1]||e.clientWidth||e.innerWidth,minHeight:arguments[2]||e.clientHeight||e.innerHeight},R.style.width="100%",R.style.height="100%"}b=!0,A=null,this.fitElement()},this.setSize=function(t,e){if("fixed"===m.name||"scale"===m.name)v=t,y=e;else{if("scale-overflow"!==m.name)throw new Error("screen mode does not support setSize: "+m.name);m.minWidth=t,m.minHeight=e}this.fitElement()},this.setScale=function(t){if("adapt"!==m.name&&"fixed"!==m.name)throw new Error("screen mode does not support setScale: "+m.name);x=t,this.fitElement()},this.fitElement=function(){var t=e.clientWidth||e.innerWidth,n=e.clientHeight||e.innerHeight;(b=!A||A.w!==t||A.h!==n)&&("adapt"===m.name?i(t,n):"fixed"===m.name?r(t,n):"scale-overflow"===m.name&&o(t,n),e===window&&window.scrollTo(0,0),A={w:t,h:n})},this.fitElement(),this.preload=function(e,n,i,r){if(!n&&0!==n)throw new Error("missing alias");if(O[n])throw new Error("sheet already exists with alias "+n);if(t.globalSheets[n])throw new Error("global sheet already exists with alias "+n);t.hasImage(e)||t.preload(e,this),O[n]=new t.Sheet(n,e,i,r)},this.sheet=function(e){if(O[e])return O[e];if(t.globalSheets[e])return t.globalSheets[e];throw new Error("invalid sheet: "+e)},this.hasSheet=function(e){return!(!O[e]&&!t.globalSheets[e])},n("isPreloading",function(){return t.isPreloading(w)});var V=null;n("onReady",{get:function(){return V},set:function(t){t&&!this.isPreloading?t.call(this):V=t}}),n("onFrame",{writable:!0});var B=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame;B(a),this.bind=function(t){for(var e=1;e<arguments.length;++e){var n=arguments[e];"string"==typeof n&&(n=n.toUpperCase().charCodeAt(0)),C[n]=t}I[t]={wasPressed:!1,wasReleased:!1,isDown:!1,framesDown:0}},this.button=function(t){return I[t]},this.pad=function(){var t;return t=1===arguments.length&&arguments[0]instanceof Array?arguments[0]:Array.prototype.slice.call(arguments),t=t.filter(function(t){return I[t].isDown}),0===t.length?null:t.reduce(function(t,e){return I[e].framesDown<I[t].framesDown?e:t},t[0])},e.addEventListener("keydown",h,!1),e.addEventListener("keyup",h,!1),n("touch",function(){return M}),n("contextMenu",{value:!0,writable:!0}),["x","y","inBounds","rel","bounded","unbounded"].forEach(function(t){Object.defineProperty(M,t,{get:function(){if(void 0===M.cur)throw new Error("No touch events happening.");return M.cur[t]}})}),e.addEventListener("mousedown",function(t){if(!M.isDown){var e=c(t);d(e.fromLeft,e.fromTop),M.isMouse=!0,M.isRightClick=2===t.button}},!1),window.addEventListener("mousemove",function(t){if(M.isMouse){var e=c(t);l(e.fromLeft,e.fromTop)}},!1),window.addEventListener("mouseup",function(t){M.isMouse&&u()},!1);var z=void 0;e.addEventListener("touchstart",function(t){if(t.preventDefault(),!M.isDown){var e=c(t.changedTouches[0]);d(e.fromLeft,e.fromTop),M.isMouse=!1,z=t.changedTouches[0].identifier}},!1),e.addEventListener("touchmove",function(t){if(t.preventDefault(),M.isDown&&!M.isMouse){var e=Array.prototype.find.call(t.changedTouches,function(t){return t.identifier===z});if(e){var n=c(e);l(n.fromLeft,n.fromTop)}}},!1),e.addEventListener("touchend",function(t){if(t.preventDefault(),M.isDown&&!M.isMouse){if(Array.prototype.find.call(t.changedTouches,function(t){return t.identifier===z}))if(0===t.targetTouches.length)u(),z=null;else{var e=t.targetTouches[t.targetTouches.length-1];z=e.identifier,l(e)}}},!1),e.addEventListener("contextmenu",function(t){p.contextMenu||t.preventDefault()}),n("hasFocus",function(){return document.hasFocus()&&document.activeElement===e})};pxcan.Panel=function(t,e,n,i,r,o,a){if(-1===[5,7].indexOf(arguments.length))throw new Error("invalid number of arguments.");5===arguments.length&&(o=t.origin().x,a=t.origin().y);var h=this,s=null,c=t.origin(),f=t.offset(),d=t.screen||t;this.canvasOffX=Math.round(t.canvasOffX+e+t.width*(t.origin().x+1)/2-i*(o+1)/2),this.canvasOffY=Math.round(t.canvasOffY+n+t.height*(t.origin().y+1)/2-r*(a+1)/2);var l=Math.round(i),u=Math.round(r);["element","canvas","context","drawScale","sheet"].forEach(function(t){Object.defineProperty(h,t,{get:function(){return d[t]}})}),Object.defineProperty(this,"screen",{get:function(){return d}}),Object.defineProperty(this,"left",{get:function(){return Math.round(f.x-l*(c.x+1)/2)}}),Object.defineProperty(this,"top",{get:function(){return Math.round(f.y-u*(c.y+1)/2)}}),Object.defineProperty(this,"right",{get:function(){return this.left+l-1}}),Object.defineProperty(this,"bottom",{get:function(){return this.top+u-1}}),Object.defineProperty(this,"width",{get:function(){return l}}),Object.defineProperty(this,"height",{get:function(){return u}}),Object.defineProperty(this,"font",{set:function(t){if(!this.hasSheet(t))throw new Error("invalid font: "+t);s=t},get:function(){return s||t.font}}),this.origin=function(t,e){if(0===arguments.length)return{x:c.x,y:c.y};if(2!==arguments.length)throw new Error("invalid arguments for origin");c={x:t,y:e}},this.offset=function(t,e){if(0===arguments.length)return{x:f.x,y:f.y};if(2!==arguments.length)throw new Error("invalid arguments for offset");f={x:t,y:e}}},pxcan.prototype.panel=pxcan.Panel.prototype.panel=function(t,e,n,i,r,o){if(4===arguments.length)return new pxcan.Panel(this,t,e,n,i);if(6===arguments.length)return new pxcan.Panel(this,t,e,n,i,r,o);throw new Error("invalid number of arguments.")},pxcan.prototype.setBackground=function(t){(this.element!==window?this.element:document.getElementsByTagName("body")[0]).style.background=t},pxcan.prototype.toCanvasCoords=pxcan.Panel.prototype.toCanvasCoords=function(t,e,n,i,r,o){if(6!==arguments.length)throw new Error("toCanvasCoords requires 6 arguments");void 0!==r&&null!==r||(r=this.origin().x),void 0!==o&&null!==o||(o=this.origin().y);var a=Math.round(this.canvasOffX+t+this.offset().x+this.width*(this.origin().x+1)/2-(n||0)*(r+1)/2),h=Math.round(this.canvasOffY+e+this.offset().y+this.height*(this.origin().y+1)/2-(i||0)*(o+1)/2),s=Math.max(0,this.canvasOffX-a,-a),c=Math.max(0,this.canvasOffY-h,-h),f=Math.max(0,a+n-(this.canvasOffX+this.width),a+n-(this.screen||this).width),d=Math.max(0,h+i-(this.canvasOffY+this.height),h+i-(this.screen||this).height);return s+f>=n||c+d>=i?null:{x:a+s,y:h+c,width:n-s-f,height:i-c-d,lcut:s,tcut:c,rcut:f,bcut:d}},pxcan.prototype.clear=pxcan.Panel.prototype.clear=function(t,e,n,i,r,o){if(-1===[0,4,6].indexOf(arguments.length))throw new Error("bad arguments for clear");if(0===arguments.length)return void(this instanceof pxcan?this.context.clearRect(0,0,this.canvas.width,this.canvas.height):this.context.clearRect(this.canvasOffX*this.drawScale,this.canvasOffY*this.drawScale,this.width*this.drawScale,this.height*this.drawScale));var a=this.toCanvasCoords(t,e,n,i,r,o);a&&this.context.clearRect(a.x*this.drawScale,a.y*this.drawScale,a.width*this.drawScale,a.height*this.drawScale)},pxcan.prototype.reset=function(){this.clear(),this.origin(0,0),this.offset(0,0)},pxcan.prototype.fill=pxcan.Panel.prototype.fill=function(t,e,n,i,r,o,a){if(-1===[1,5,7].indexOf(arguments.length))throw new Error("bad arguments for fill");var h=this.context.fillStyle;if(this.context.fillStyle=t,1===arguments.length)return this instanceof pxcan?this.context.fillRect(0,0,this.canvas.width,this.canvas.height):this.context.fillRect(this.canvasOffX*this.drawScale,this.canvasOffY*this.drawScale,this.width*this.drawScale,this.height*this.drawScale),void(this.context.fillStyle=h);var s=this.toCanvasCoords(e,n,i,r,o,a);s&&(this.context.fillRect(s.x*this.drawScale,s.y*this.drawScale,s.width*this.drawScale,s.height*this.drawScale),this.context.fillStyle=h)},pxcan.prototype.blit=pxcan.Panel.prototype.blit=function(t){var e=arguments;if(-1===[3,4,5,6,7,8].indexOf(arguments.length))throw new Error("bad arguments for blit");var n,i,r=null,o=null,a="",h=void 0,s=void 0;!function(){var t=void 0;"number"==typeof e[e.length-3]&&"number"==typeof e[e.length-4]?(n=e[e.length-4],i=e[e.length-3],h=e[e.length-2],s=e[e.length-1],t=e.length-4):(n=e[e.length-2],i=e[e.length-1],t=e.length-2);var c=1;c<t&&Array.isArray(e[c])&&(r=e[c],++c),c<t&&-1!==["number","object"].indexOf(_typeof(e[c]))&&(o=e[c],++c),c<t&&"string"==typeof e[c]&&(a=e[c],++c)}();var c=this.sheet(t);if(!c)throw new Error("unknown sheet: "+t);var f=r&&r.length>0?pxcan.recolorImage(c.src,r):c.src,d=null!==o?c.getSprite(o):c,l=!1,u=!1,g=!1;a.replace("90","c").replace("180","xy").replace("270","cxy").split("").forEach(function(t){if("x"===t||"h"===t)l=!l;else if("y"===t||"v"===t)u=!u;else if("c"===t){g&&(l=!l,u=!u),g=!g;var e=l;l=u,u=e}});var w=this.toCanvasCoords(n,i,g?d.height:d.width,g?d.width:d.height,h,s);w&&((l||u||g)&&(this.context.save(),this.context.setTransform(+!g&&(l?-1:1),+g&&(u?-1:1),+g&&(l?1:-1),+!g&&(u?-1:1),this.canvas.width*+l,this.canvas.height*+u)),g?this.context.drawImage(pxcan.scaledImage(f,this.drawScale),(d.left+(u?w.bcut:w.tcut))*this.drawScale,(d.top+(l?w.lcut:w.rcut))*this.drawScale,w.height*this.drawScale,w.width*this.drawScale,this.canvas.height*+u+(w.y*(u?-1:1)-w.height*+u)*this.drawScale,-this.canvas.width*+l-(w.x*(l?-1:1)+w.width*+!l)*this.drawScale,w.height*this.drawScale,w.width*this.drawScale):this.context.drawImage(pxcan.scaledImage(f,this.drawScale),(d.left+(l?w.rcut:w.lcut))*this.drawScale,(d.top+(u?w.bcut:w.tcut))*this.drawScale,w.width*this.drawScale,w.height*this.drawScale,this.canvas.width*+l+(w.x*(l?-1:1)-w.width*+l)*this.drawScale,this.canvas.height*+u+(w.y*(u?-1:1)-w.height*+u)*this.drawScale,w.width*this.drawScale,w.height*this.drawScale),(g||l||u)&&this.context.restore())},pxcan.prototype.write=pxcan.Panel.prototype.write=function(t){if(-1===[3,4,5,6].indexOf(arguments.length))throw new Error("bad arguments for write");if(void 0===t||null===t)throw new Error("text is "+t);"string"!=typeof t&&(t=t.toString());var e,n,i,r,o,a,h="number"==typeof arguments[1]?1:2;e="number"==typeof arguments[1]?[]:[arguments[1]],n=arguments[h],i=arguments[h+1],arguments.length>=h+3?(r=arguments[h+2],o=arguments[h+3]):(r=this.origin().x,o=this.origin().y),a=-1!==[h+3,h+5].indexOf(arguments.length)?arguments[arguments.length-1]:0;var s=this.sheet(this.font);if("string"==typeof a)if("left"===a)a=0;else if("center"===a)a=.5;else{if("right"!==a)throw new Error("unknown text alignment: "+a);a=1}for(var c=t.split("\n"),f=0,d=0;d<c.length;++d)f=Math.max(c[d].length,f);for(var l=s.spriteWidth,u=s.spriteHeight,g=Math.round(n-(f-1)*l*((r+1)/2)),w=Math.round(i-(c.length-1)*u*((o+1)/2)),p=0;p<c.length;++p)for(var m=Math.round((f-c[p].length)*a*l),v=0;v<c[p].length;++v)this.blit(this.font,e,c[p].charCodeAt(v)-32,g+m+v*l,w+p*u,r,o)},pxcan.prototype.border=pxcan.Panel.prototype.border=function(){var t="pxborder",e=null;arguments.length>0&&("string"==typeof arguments[0]&&(t=arguments[0]),Array.isArray(arguments[arguments.length-1])&&(e=arguments[arguments.length-1]));var n=this.origin(),i=this.offset();this.origin(-1,-1),this.offset(0,0);for(var r=this.sheet(t).spriteWidth,o=r;o<this.width-r;o+=r)this.blit(t,e,{col:1,row:0},o,0,-1,-1),this.blit(t,e,{col:1,row:2},o,this.height,-1,1);for(var a=this.sheet(t).spriteHeight,h=a;h<this.height-a;h+=a)this.blit(t,e,{col:0,row:1},0,h,-1,-1),this.blit(t,e,{col:2,row:1},this.width,h,1,-1);this.blit(t,e,{col:0,row:0},0,0,-1,-1),this.blit(t,e,{col:2,row:0},this.width,0,1,-1),this.blit(t,e,{col:0,row:2},0,this.height,-1,1),this.blit(t,e,{col:2,row:2},this.width,this.height,1,1),this.origin(n.x,n.y),this.offset(i.x,i.y)},function(){var t=[],e={},n={},i=0,r={};pxcan.assignId=function(){var e=-1;return function(i){return t.push(i),n[e+1]=0,++e}}(),pxcan.isPreloading=function(t){return!!n[t.id]||i>0},pxcan.preload=function(o,a){function h(){if(r[o]={image:c,scaledImages:{1:document.createElement("canvas")}},r[o].scaledImages[1].width=c.width,r[o].scaledImages[1].height=c.height,r[o].scaledImages[1].getContext("2d").drawImage(c,0,0),s?--i:e[o].forEach(function(t){return--n[t.id]}),!(i>0||e[o]&&e[o].every(function(t){return n[t.id]}))){(s?t:e[o]).filter(function(t){return!n[t.id]}).forEach(function(t){t.onReady&&t.onReady.call(t),t.onReady=null}),delete e[o]}}var s=!a;if(!o)throw new Error("missing source image");if(r[o])return void console.log("note: "+o+" was already preloaded.");if(e[o])return s?void console.log("note: "+o+" was already requested to be preloaded"):e[o].indexOf(a)>=0?void console.log("note: "+o+" was already requested to be preloaded by this pxcan"):(console.log("note: "+o+" was already requested to be preloaded by a different pxcan"),e[o].push(a),void++n[a.id]);s?++i:(e[o]=[a],++n[a.id]);var c=new Image;c.onload=h,c.onerror=function(){throw new Error("Failed to load image "+o)},c.src=o},pxcan.hasImage=function(t){return!!r[t]},pxcan.image=function(t){if(!pxcan.hasImage(t))throw new Error("invalid image src: "+t);return r[t].image},pxcan.recolorImage=function(t,e){if(!r[t])throw new Error("invalid image src: "+t);var n=t+"@"+e.join(",");if(r[n])return n;var i=document.createElement("canvas"),o=r[t].scaledImages[1];i.width=o.width,i.height=o.height;var a=i.getContext("2d"),h=new Uint32Array(o.getContext("2d").getImageData(0,0,o.width,o.height).data.buffer),s=[],c=Array.prototype.map.call(h,function(t){if(0==(4278190080&t))return 0;var e=s.indexOf(t);return-1!==e?e+1:(s.push(t),s.length)});s=s.map(function(t,e){return{oldIdx:e,brightness:(255&t)+((65280&t)>>8)+((16711680&t)>>16)}}).sort(function(t,e){return t.brightness-e.brightness}),s.forEach(function(t,e){return t.bIdx=e+1}),s.sort(function(t,e){return t.oldIdx-e.oldIdx}),c=Array.prototype.map.call(c,function(t){return 0===t?0:s[t-1].bIdx});for(var f=0,d=0;d<o.height;++d)for(var l=0;l<o.width;++l)0!==c[f]&&(a.fillStyle=e[c[f]-1],a.fillRect(l,d,1,1)),++f;return r[n]={scaledImages:{1:i}},n},pxcan.scaledImage=function(t,e){if(!r[t])throw new Error("invalid image src: "+t);if(r[t].scaledImages[e])return r[t].scaledImages[e];var n=document.createElement("canvas"),i=r[t].scaledImages[1];n.width=i.width*e,n.height=i.height*e;for(var o=n.getContext("2d"),a=i.getContext("2d").getImageData(0,0,i.width,i.height).data,h=0,s=0;s<i.height;++s)for(var c=0;c<i.width;++c)o.fillStyle="rgba("+a[h]+","+a[h+1]+","+a[h+2]+","+a[h+3]+")",o.fillRect(c*e,s*e,e,e),h+=4;return r[t].scaledImages[e]=n,n}}(),pxcan.Sheet=function(t,e,n,i){Object.defineProperty(this,"alias",{get:function(){return t}}),Object.defineProperty(this,"img",{get:function(){return pxcan.image(e)}}),Object.defineProperty(this,"src",{get:function(){return e}}),Object.defineProperty(this,"left",{get:function(){return 0}}),Object.defineProperty(this,"top",{get:function(){return 0}}),Object.defineProperty(this,"width",{get:function(){return this.img.width}}),Object.defineProperty(this,"height",{get:function(){return this.img.height}}),Object.defineProperty(this,"spriteWidth",{get:function(){return n||this.img.width}}),Object.defineProperty(this,"spriteHeight",{get:function(){return i||this.img.height}}),Object.defineProperty(this,"numCols",{get:function(){return Math.floor(this.img.width/n)}}),Object.defineProperty(this,"numRows",{get:function(){return Math.floor(this.img.height/i)}}),Object.defineProperty(this,"numSprites",{get:function(){return this.numCols*this.numRows}})},pxcan.Sheet.prototype.scaledImage=function(t){return pxcan.scaledImage(this.src,t)},pxcan.Sheet.prototype.getSprite=function(t){return new pxcan.Sprite(this,t)},pxcan.Sprite=function(t,e){if(void 0===e||null===e)throw new Error("bad frame while constructing sprite");"number"==typeof e&&e%1==0&&(e={col:e%t.numCols,row:Math.floor(e/t.numCols)});var n=void 0!==e.x?e.x:e.col?e.col*t.spriteWidth:0,i=void 0!==e.y?e.y:e.row?e.row*t.spriteHeight:0,r=void 0!==e.width?e.width:void 0!==e.col?t.spriteWidth:t.width-n,o=void 0!==e.height?e.height:void 0!==e.row?t.spriteHeight:t.height-i;Object.defineProperty(this,"sheet",{get:function(){return t}}),Object.defineProperty(this,"img",{get:function(){return t.img}}),Object.defineProperty(this,"left",{get:function(){return n}}),Object.defineProperty(this,"top",{get:function(){return i}}),Object.defineProperty(this,"width",{get:function(){return r}}),Object.defineProperty(this,"height",{get:function(){return o}})},pxcan.Sprite.prototype.scaledImage=function(t){return pxcan.scaledImage(this.sheet.src,t)},pxcan.globalSheets={},function(){function t(t,e,n,i){pxcan.preload(t),pxcan.globalSheets[e]=new pxcan.Sheet(e,t,n,i)}t("data:image/png;base64,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","px8",8,8),t("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAABICAYAAACECrc3AAACZElEQVRogeWWSXKDQAxFff9Lk03KBeJP6gbcTrSJERqevkRVXq9vte3X9s/7v8q/7Qy9Y3Go7xTgRgwNwoZjA0eAaZyC7sBdbg7GAU7BJglu7QxGDfe9Vg+creSJaU89GFDyhd0BPASY3htrmN4ajEkVTAuOqirz3A1e0sTEfu/X3PlIOh9T3Qi6a3bTbz/7EFAyA+j4UD307gDIirPCSkWkglLPwiuVFIjKTXydOtEtpMowmGRgCri8pdN9hAXtf/bOUCP3LHspBUdUTPNY3MHfUehuBVuTJAXuuNFP3P28oXtjz+5WVS0WJ/u41e4LIh/KV7koTvnsf8qJMgkgEwLFU2qnVtpY5SoYCovUYjBOCaU066HqrW9OLedjubXH8JZQIHtWhStMAljzIQtK7gDWPFcHQVlABpQqyBreBuhWkgC6xmpQ1GtdY8TV5+KuULC14q4PDa5+twDTiROlU0AEBhmYCrUx+818twPSBFAwBWZxSb11TUlefckdOpVYbwmIbkEVSe8tyWlDVl9t3gV24BGcgkwajEK3AF3R9AZVbsLCeqxrKenIRB3V6vMhl93QPtCt1zVxZ1Cf5XAo0Plc7szAjwC6Pp13cJInVszi1jYlP1NrJPdywE5ucovDJ+MClU8plQCqQQ+AqqhrXH0qzsEMAdaVJBAzgGor/8cuVcB9JHUlNZadAsqtdRJf+z7qEGxo9jwE2FGQGSxu3qntQAVVYxTHhqvNVCyCYjX/tqUrTmu9VewcsFqTA1I+x0AD1X3VOChFyUnEON0kJDZTKmAWm6751I/dDpq4o+oIHOr1AxFeE6QKBXbuAAAAAElFTkSuQmCC","px6",5,6),t("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAhElEQVRIie2WwQrAIAxDU/H/fzk7CdHVwdYWdjCXipQX04NqJIlCdVkbAG5q2EAh3NSQgUJCJxaeAaAm+DqONaEpp22a3mgCrrwmTVG5jIwEj8pM4HKa15WpY3AM/m3AagOrNrglyLouJp4aZF1400u4vmhZJmMa7IiPxvsojH1Y9bflAvhRIjH91XRBAAAAAElFTkSuQmCC","pxborder",8,8)}();var pxMath={mid:function(){for(var t=[],e=0;e<arguments.length;++e)t.push(+arguments[e]);return t.sort(function(t,e){return t-e}),t.length%2==1?t[Math.floor(t.length/2)]:(t[Math.floor(t.length/2)]+t[Math.floor(t.length/2)-1])/2},clamp:function(t,e,n){return 2===arguments.length&&(n=arguments[1],e=-arguments[1]),pxMath.mid(e,t,n)}};pxcan.random=function(){function t(t){var e,n,i,r=0;if(0==t.length)return r;for(e=0,i=t.length;e<i;e++)n=t.charCodeAt(e),r=(r<<5)-r+n,r|=0;return r}function e(e){if("number"==typeof e)return e;if("string"==typeof e)return t(e);throw new Error("not sure what to do with seed: "+e)}function n(t){var i=e(t),r=function(){var t=1e4*Math.sin(i++);if(t-=Math.floor(t),0===arguments.length)return t;if(1===arguments.length&&arguments[0]instanceof Array)return arguments[0][Math.floor(t*arguments[0].length)];if(1===arguments.length)return Math.floor(t*arguments[0]);if(2===arguments.length)return Math.floor(t*(arguments[1]+1-arguments[0]))+arguments[0];throw new Error("invalid arguments for random generator.")};return r.seed=function(t){i=e(t)},r.create=function(t){return n(void 0!==t?t:r())},r}return n(Math.random())}(),pxcan.wrapString=function(t,e,n){if(!t)return t;var i=".{1,"+e+"}(\\s|$)|.{"+e+"}|.+$",r=t.match(RegExp(i,"g"));n&&(r=r.slice(0,n));for(var o=0;o<r.length;++o)r[o]=r[o].trim();return r.join("\n")};