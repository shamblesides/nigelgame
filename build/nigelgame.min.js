function nigelgame(a){function b(b){function c(){y||(y=!0,i?(++B,B>i&&(B=0,d())):d(),y=!1,window.requestAnimationFrame(c))}function d(){if(b.nextView){var a=b.nextView;b.nextView=null,b=a,A=0}e.fitElement(),b.update&&b.update({viewClock:A,gameClock:z,screen:e,buttons:v}),++A,++z;for(var c in v)v.hasOwnProperty(c)&&++v[c].length}function j(a){h||a.preventDefault();var c=f[a.keyCode];return void 0===c?!0:!v[c]&&(v[c]={length:0},b.buttondown)?b.buttondown(c):void 0}function k(a){var c=f[a.keyCode];return void 0===c?!0:v[c]&&(v[c]=!1,b.buttonup)?b.buttonup(c):void 0}function l(a){b.keypress&&b.keypress(a)&&a.preventDefault()}function m(b){return new n(Math.floor((b.clientX-(a.clientLeft||0)-(a.offsetLeft||0))/(a.clientWidth||a.innerWidth)*e.width),Math.floor((b.clientY-(a.clientTop||0)-(a.offsetTop||0))/(a.clientHeight||a.innerHeight)*e.height),null)}function n(a,b,c){this.x=a+(c&&c.left||0),this.y=b+(c&&c.top||0),this.equals=function(a){return this.x===a.x&&this.y===a.y},this.inBounds=function(){c&&this.x>=0&&this.y>=0&&this.x<e.width&&this.y<e.height},this.relativeTo=function(a){return new n(this.x-(c&&c.left||0),this.y-(c&&c.top||0),a)}}function o(a){return 2===a.button?"rightmouse":"mouse"}function p(a){var c={screen:e,type:o(a),point:m(a)};b.touch&&b.touch(c),w.startPoint=c.point,w.lastPoint=c.point,w.button=c.type}function q(a){if(w.startPoint){var c={screen:e,type:w.button,point:m(a),lastPoint:w.lastPoint,startPoint:w.startPoint};c.point.equals(c.lastPoint)||(b.drag&&b.drag(c),w.lastPoint=c.point)}}function r(a){b.release&&w.startPoint&&w.button===o(a)&&b.release({screen:e,type:w.button,point:m(a),startPoint:w.startPoint}),w.startPoint=null,w.lastPoint=null}function s(a){if(a.preventDefault(),a.touches.length===a.changedTouches.length){var c={screen:e,type:"touch",point:m(a.changedTouches[0])};b.touch&&b.touch(c),x.startPoint=c.point,x.lastPoint=c.point,x.id=a.changedTouches[0].identifier}}function t(a){if(a.preventDefault(),x.startPoint){var c=0;for(c=0;;++c){if(c===a.changedTouches.length)return;if(a.changedTouches[c].identifier===x.id)break}var d={screen:e,type:"touch",point:m(a.changedTouches[c]),lastPoint:x.lastPoint,startPoint:x.startPoint};d.point.equals(d.lastPoint)||(b.drag&&b.drag(d),w.lastPoint=d.point)}}function u(a){if(a.preventDefault(),x.startPoint){var c=0;for(c=0;;++c){if(c===a.changedTouches.length)return;if(a.changedTouches[c].identifier===x.id)break}if(0===a.targetTouches.length)b.release&&b.release({screen:e,type:"touch",point:m(a.changedTouches[c]),startPoint:x.startPoint}),x.id=null,x.startPoint=null,x.lastPoint=null;else{var d=a.targetTouches[a.targetTouches.length-1],f=m(d);b.drag&&b.drag({screen:e,type:"touch",point:f,lastPoint:x.lastPoint,startPoint:x.startPoint}),x.id=d.identifier,x.lastPoint=f}}}var v={},w={startPoint:null,lastPoint:null,button:null},x={id:null,startPoint:null,lastPoint:null},y=!1,z=0,A=0,B=0;f&&(a.addEventListener("keydown",j,!1),a.addEventListener("keyup",k,!1)),h&&a.addEventListener("keypress",l,!1),g&&(a.addEventListener("mousedown",p,!1),a.addEventListener("mouseup",r,!1),a.addEventListener("mousemove",q,!1),a.addEventListener("touchstart",s,!1),a.addEventListener("touchmove",t,!1),a.addEventListener("touchend",u,!1),a.addEventListener("contextmenu",function(a){return a.preventDefault(),!1},!1)),window.requestAnimationFrame(c)}var c=0,d=null,e=new nigelgame.Screen(a);this.setScreenMode=function(){e.mode.apply(e,arguments)},this.setScreenSize=function(){e.setSize.apply(e,arguments)},this.setScreenScale=function(){e.setScale.apply(e,arguments)},this.addJSON=function(a,b){function e(){nigelgame.json[b]=JSON.parse(g.response),--c,0===c&&d&&(d(),d=null)}if(!a)throw"missing json source filename";if(!b)throw"missing alias";if(nigelgame.json[b]){var f=nigelgame.json[b];if(f.src===a)return;throw"Duplicate alias for "+f.alias+"("+f.src+", "+a+")"}++c;var g=new XMLHttpRequest;g.open("GET",a),g.overrideMimeType("application/json"),g.onloadend=e,g.onerror=function(){throw"Error loading JSON file: "+a},g.ontimeout=function(){throw"Request timed out: "+a},g.send()};var f=null;this.bind=function(a){f||(f={});for(var b=1;b<arguments.length;++b)f[arguments[b]]=a};var g=!1;this.activateTouch=function(){g=!0};var h=!1;this.activateKeyboard=function(){h=!0};var i=0;this.setFrameSkip=function(a){i=a};var j=!1;this.start=function(a){if(j)throw new Error("game is already started!");j=!0,c>0?d=function(){b(a)}:b(a)}}nigelgame.sheets={},nigelgame.json={},window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame,Math.sign=function(a){return(a=parseFloat(a))?a>0?1:-1:a},Math.mid=function(){for(var a=[],b=0;b<arguments.length;++b)a.push(+arguments[b]);return a.sort(function(a,b){return a-b}),a.length%2===1?a[Math.floor(a.length/2)]:(a[Math.floor(a.length/2)]+a[Math.floor(a.length/2)-1])/2},Math.cap=function(a,b){return Math.mid(-b,a,b)},String.prototype.hashCode=function(){var a,b,c,d=0;if(0==this.length)return d;for(a=0,c=this.length;c>a;a++)b=this.charCodeAt(a),d=(d<<5)-d+b,d|=0;return d},nigelgame.random=function(){function a(a){if("number"==typeof a)return a;if("string"==typeof a)return a.hashCode();throw new Error("not sure what to do with seed: "+a)}function b(c){var d=a(c),e=function(){var a=1e4*Math.sin(d++);if(a-=Math.floor(a),0===arguments.length)return a;if(1===arguments.length&&arguments[0]instanceof Array)return arguments[0][Math.floor(a*arguments[0].length)];if(1===arguments.length)return Math.floor(a*arguments[0]);if(2===arguments.length)return Math.floor(a*(arguments[1]+1-arguments[0]))+arguments[0];throw new Error("invalid arguments for random generator.")};return e.seed=function(b){d=a(b)},e.create=function(a){return b(void 0!==a?a:e())},e}return b(Math.random())}(),nigelgame.wrapString=function(a,b,c){if(!a)return a;var d=".{1,"+b+"}(\\s|$)|.{"+b+"}|.+$",e=a.match(RegExp(d,"g"));c&&(e=e.slice(0,c));for(var f=0;f<e.length;++f)e[f]=e[f].trim();return e.join("\n")};var pxcan=function(a){function b(a,b){o.width=(f=Math.floor(a/h))*h,o.height=(g=Math.floor(b/h))*h}function c(){o.width!==f*h&&(o.width=f*h),o.height!==g*h&&(o.height=g*h)}function d(a,b){e.minWidth*b===e.minHeight*a?(f=e.minWidth,g=e.minHeight):e.minWidth*b<e.minHeight*a?(f=Math.floor(a/b*e.minHeight),g=e.minHeight):(f=e.minWidth,g=Math.floor(b/a*e.minWidth)),h=Math.floor(Math.min(b/g,a/f)),1>h&&(h=1),o.width=f*h,o.height=g*h}a=a||window,"string"==typeof a&&(a=document.querySelector(a));var e={name:"adapt"},f=a.clientWidth||a.innerWidth,g=a.clientHeight||a.innerWidth,h=1,i=!0,j=null,k="pxcan-ascii",l={},m={x:0,y:0},n={x:0,y:0},o=document.createElement("canvas");o.style.display="block",o.style.margin="auto";var p=o.getContext("2d");if(a==window){var q=document.querySelector("body");q.style.padding=0,q.style.margin=0,q.style.overflow="hidden"}(a!==window?a:document.getElementsByTagName("body")[0]).appendChild(o),a!==window&&a.tabIndex<0&&(a.tabIndex=0),Object.defineProperty(this,"element",{get:function(){return a}}),Object.defineProperty(this,"canvas",{get:function(){return o}}),Object.defineProperty(this,"context",{get:function(){return p}}),Object.defineProperty(this,"canvasOffX",{get:function(){return 0}}),Object.defineProperty(this,"canvasOffY",{get:function(){return 0}}),Object.defineProperty(this,"left",{get:function(){return Math.round(n.x-f*(m.x+1)/2)}}),Object.defineProperty(this,"top",{get:function(){return Math.round(n.y-g*(m.y+1)/2)}}),Object.defineProperty(this,"right",{get:function(){return this.left+f}}),Object.defineProperty(this,"bottom",{get:function(){return this.top+g}}),Object.defineProperty(this,"width",{get:function(){return f}}),Object.defineProperty(this,"height",{get:function(){return g}}),Object.defineProperty(this,"drawScale",{get:function(){return h}}),Object.defineProperty(this,"wasResized",{get:function(){return i}}),Object.defineProperty(this,"font",{set:function(a){if(!this.hasSheet(a))throw new Error("invalid font: "+a);k=a},get:function(){if(!k)throw new Error("font has not been set.");return k}}),Object.defineProperty(this,"onReady",{writable:!0}),Object.defineProperty(this,"onFrame",{writable:!0}),this.preload=function(a,b,c,d){if(!b&&0!==b)throw new Error("missing alias");if(l[b])throw new Error("sheet already exists with alias "+b);if(pxcan.globalSheets[b])throw new Error("global sheet already exists with alias "+b);pxcan.hasImage(a)||pxcan.preload(a,this),l[b]=new pxcan.Sheet(b,a,c,d)},this.sheet=function(a){if(l[a])return l[a];if(pxcan.globalSheets[a])return pxcan.globalSheets[a];throw new Error("invalid sheet: "+a)},this.hasSheet=function(a){return!(!l[a]&&!pxcan.globalSheets[a])},this.origin=function(a,b){if(0===arguments.length)return{x:m.x,y:m.y};if(2!==arguments.length)throw new Error("invalid arguments for origin");m={x:a,y:b}},this.offset=function(a,b){if(0===arguments.length)return{x:n.x,y:n.y};if(2!==arguments.length)throw new Error("invalid arguments for offset");n={x:a,y:b}},this.mode=function(b){if(0===arguments.length)return e.name;if("adapt"===b)e={name:"adapt"},h=arguments[1]||1,o.style.width="",o.style.height="";else if("fixed"===b)e={name:"fixed"},arguments.length<=2?(h=arguments[1]||1,f=Math.floor((a.clientWidth||a.innerWidth)/h),g=Math.floor((a.clientHeight||a.innerHeight)/h)):(f=arguments[1],g=arguments[2],h=arguments[3]||1),o.style.width="",o.style.height="";else{if("scale-overflow"!==b)throw new Error("scale"===b?"not yet supported.":"unknown mode type.");e={name:"scale-overflow",minWidth:arguments[1]||a.clientWidth||a.innerWidth,minHeight:arguments[2]||a.clientHeight||a.innerHeight},o.style.width="100%",o.style.height="100%"}i=!0,j=null,this.fitElement()},this.setSize=function(a,b){if("fixed"===e.name||"scale"===e.name)f=a,g=b;else{if("scale-overflow"!==e.name)throw new Error("screen mode does not support setSize: "+e.name);e.minWidth=a,e.minHeight=b}this.fitElement()},this.setScale=function(a){if("adapt"!==e.name&&"fixed"!==e.name)throw new Error("screen mode does not support setScale: "+e.name);h=a,this.fitElement()},this.fitElement=function(){var f=a.clientWidth||a.innerWidth,g=a.clientHeight||a.innerHeight;i=!j||j.w!==f||j.h!==g,i&&("adapt"===e.name?b(f,g):"fixed"===e.name?c(f,g):"scale-overflow"===e.name&&d(f,g),a===window&&window.scrollTo(0,0),j={w:f,h:g})},this.fitElement()};pxcan.Panel=function(a,b,c,d,e,f,g){if(-1===[5,7].indexOf(arguments.length))throw new Error("invalid number of arguments.");5===arguments.length&&(f=a.origin().x,g=a.origin().y);var h=null,i=a.origin(),j=a.offset(),k=a.screen||a;this.canvasOffX=Math.round(a.canvasOffX+b+a.width*(a.origin().x+1)/2-d*(f+1)/2),this.canvasOffY=Math.round(a.canvasOffY+c+a.height*(a.origin().y+1)/2-e*(g+1)/2);var l=Math.round(d),m=Math.round(e);Object.defineProperty(this,"screen",{get:function(){return k}}),Object.defineProperty(this,"element",{get:function(){return k.element}}),Object.defineProperty(this,"canvas",{get:function(){return k.canvas}}),Object.defineProperty(this,"context",{get:function(){return k.context}}),Object.defineProperty(this,"left",{get:function(){return Math.round(j.x-l*(i.x+1)/2)}}),Object.defineProperty(this,"top",{get:function(){return Math.round(j.y-m*(i.y+1)/2)}}),Object.defineProperty(this,"right",{get:function(){return this.left+l}}),Object.defineProperty(this,"bottom",{get:function(){return this.top+m}}),Object.defineProperty(this,"width",{get:function(){return l}}),Object.defineProperty(this,"height",{get:function(){return m}}),Object.defineProperty(this,"drawScale",{get:function(){return k.drawScale}}),Object.defineProperty(this,"sheet",{get:function(){return k.sheet}}),Object.defineProperty(this,"font",{set:function(a){if(!this.hasSheet(a))throw new Error("invalid font: "+a);h=a},get:function(){return h||a.font}}),this.origin=function(a,b){if(0===arguments.length)return{x:i.x,y:i.y};if(2!==arguments.length)throw new Error("invalid arguments for origin");i={x:a,y:b}},this.offset=function(a,b){if(0===arguments.length)return{x:j.x,y:j.y};if(2!==arguments.length)throw new Error("invalid arguments for offset");j={x:a,y:b}}},pxcan.prototype.panel=pxcan.Panel.prototype.panel=function(a,b,c,d,e,f){if(4===arguments.length)return new pxcan.Panel(this,a,b,c,d);if(6===arguments.length)return new pxcan.Panel(this,a,b,c,d,e,f);throw new Error("invalid number of arguments.")},pxcan.prototype.setBackground=function(a){this.element.style.background=a},pxcan.prototype.toCanvasCoords=pxcan.Panel.prototype.toCanvasCoords=function(a,b,c,d,e,f){if(6!==arguments.length)throw new Error("toCanvasCoords requires 6 arguments");(void 0===e||null===e)&&(e=this.origin().x),(void 0===f||null===f)&&(f=this.origin().y);var g=Math.round(this.canvasOffX+a+this.offset().x+this.width*(this.origin().x+1)/2-(c||0)*(e+1)/2),h=Math.round(this.canvasOffY+b+this.offset().y+this.height*(this.origin().y+1)/2-(d||0)*(f+1)/2),i=Math.max(0,this.canvasOffX-g,-g),j=Math.max(0,this.canvasOffY-h,-h),k=Math.max(0,g+c-(this.canvasOffX+this.width),g+c-(this.screen||this).width),l=Math.max(0,h+d-(this.canvasOffY+this.height),h+d-(this.screen||this).height);return i+k>=c||j+l>=d?null:{x:g+i,y:h+j,width:c-i-k,height:d-j-l,lcut:i,tcut:j,rcut:k,bcut:l}},pxcan.prototype.clear=pxcan.Panel.prototype.clear=function(a,b,c,d,e,f){if(-1===[0,4,6].indexOf(arguments.length))throw new Error("bad arguments for clear");if(0===arguments.length)return void(this instanceof pxcan?this.context.clearRect(0,0,this.canvas.width,this.canvas.height):this.context.clearRect(this.canvasOffX*this.drawScale,this.canvasOffY*this.drawScale,this.width*this.drawScale,this.height*this.drawScale));var g=this.toCanvasCoords(a,b,c,d,e,f);g&&this.context.clearRect(g.x*this.drawScale,g.y*this.drawScale,g.width*this.drawScale,g.height*this.drawScale)},pxcan.prototype.reset=function(){this.clear(),this.origin(0,0),this.offset(0,0)},pxcan.prototype.fill=pxcan.Panel.prototype.fill=function(a,b,c,d,e,f,g){if(-1===[1,5,7].indexOf(arguments.length))throw new Error("bad arguments for fill");var h=this.context.fillStyle;if(this.context.fillStyle=a,1===arguments.length)return this instanceof pxcan?this.context.fillRect(0,0,this.canvas.width,this.canvas.height):this.context.fillRect(this.canvasOffX*this.drawScale,this.canvasOffY*this.drawScale,this.width*this.drawScale,this.height*this.drawScale),void(this.context.fillStyle=h);var i=this.toCanvasCoords(b,c,d,e,f,g);i&&(this.context.fillRect(i.x*this.drawScale,i.y*this.drawScale,i.width*this.drawScale,i.height*this.drawScale),this.context.fillStyle=h)},pxcan.prototype.blit=pxcan.Panel.prototype.blit=function(a,b){if(-1===[4,5,6,7].indexOf(arguments.length))throw new Error("bad arguments for blit");var c=arguments.length%2===1&&arguments[2]||"",d=arguments[arguments.length%2===0?2:3],e=arguments[arguments.length%2===0?3:4],f=arguments.length>=6?arguments[arguments.length-2]:null,g=arguments.length>=6?arguments[arguments.length-1]:null,h=this.sheet(a);if(!h)throw new Error("unknown sheet: "+a);var i=void 0!==b&&null!==b?h.getSprite(b):h,j=this.toCanvasCoords(d,e,i.width,i.height,f,g);if(j){var k=-1!==c.indexOf("h")?1:0,l=-1!==c.indexOf("v")?1:0;c&&(this.context.translate(this.canvas.width*k,this.canvas.height*l),this.context.scale(k?-1:1,l?-1:1)),this.context.drawImage(i.scaledImage(this.drawScale),(i.left+(k?j.rcut:j.lcut))*this.drawScale,(i.top+(l?j.bcut:j.tcut))*this.drawScale,j.width*this.drawScale,j.height*this.drawScale,this.canvas.width*k+(j.x*(k?-1:1)-j.width*k)*this.drawScale,this.canvas.height*l+(j.y*(l?-1:1)-j.height*l)*this.drawScale,j.width*this.drawScale,j.height*this.drawScale),c&&(this.context.translate(this.canvas.width*k,this.canvas.height*l),this.context.scale(k?-1:1,l?-1:1))}},pxcan.prototype.write=pxcan.Panel.prototype.write=function(a,b,c,d){var e=this.sheet(this.font);d=d||{},(d.cols||d.rows)&&(a=nigelgame.wrapString(a,d.cols,d.rows));var f=d&&d.anchor||{};void 0===f.x&&(f.x=this.origin().x||0),void 0===f.y&&(f.y=this.origin().y||0);for(var g=a.split("\n"),h=0,i=0;i<g.length;++i)h=Math.max(g[i].length,h);var j=0;if(d&&d.align&&"left"!==d.align)if("center"===d.align)j=.5;else{if("right"!==d.align)throw"unknown text alignment: "+d.align;j=1}else j=0;var k=this.toCanvasCoords(b,c,e.spriteWidth*h,e.spriteHeight*g.length,null,null);if(k)for(var l=e.spriteWidth,m=e.spriteHeight,n=0;n<g.length;++n)for(var o=Math.round((h-g[n].length)*j*e.spriteWidth),p=0;p<g[n].length;++p){var q=g[n].charCodeAt(p)-32,r=e.getSprite(q);this.context.drawImage(r.scaledImage(this.drawScale),r.left*this.drawScale,r.top*this.drawScale,r.width*this.drawScale,r.height*this.drawScale,(k.x+o+p*l)*this.drawScale,(k.y+n*m)*this.drawScale,l*this.drawScale,m*this.drawScale)}},pxcan.prototype.border=pxcan.Panel.prototype.border=function(a){a=a||"pxcan-border";var b=this.origin(),c=this.offset();this.origin(-1,-1),this.offset(0,0);for(var d=this.sheet(a).spriteWidth,e=d;e<this.width-d;e+=d)this.blit(a,{col:1,row:0},e,0,-1,-1),this.blit(a,{col:1,row:2},e,this.height,-1,1);for(var f=this.sheet(a).spriteHeight,g=f;g<this.height-f;g+=f)this.blit(a,{col:0,row:1},0,g,-1,-1),this.blit(a,{col:2,row:1},this.width,g,1,-1);this.blit(a,{col:0,row:0},0,0,-1,-1),this.blit(a,{col:2,row:0},this.width,0,1,-1),this.blit(a,{col:0,row:2},0,this.height,-1,1),this.blit(a,{col:2,row:2},this.width,this.height,1,1),this.origin(b.x,b.y),this.offset(c.x,c.y)},function(){var a=0;Object.defineProperty(pxcan.prototype,"__id",{writable:!0}),Object.defineProperty(pxcan.prototype,"id",{get:function(){return void 0==this.__id&&(this.__id=a++),this.__id}})}(),function(){var a={},b={},c={},d={};pxcan.isPreloading=function(a){return!!b[a.id]},pxcan.preload=function(e,f){function g(){if(d[e]={image:h,scaledImages:{1:document.createElement("canvas")}},d[e].scaledImages[1]=document.createElement("canvas"),d[e].scaledImages[1].width=h.width,d[e].scaledImages[1].height=h.height,d[e].scaledImages[1].getContext("2d").drawImage(h,0,0),a[e]){for(var f=0;f<a[e].length;++f){var g=a[e][f];if(--b[g],0===b[g]&&c[g].onReady){var i=c[g];i.onReady.call(i),i.onReady=null,delete c[g]}}delete a[e]}}if(!e)throw new Error("missing source image");if(f&&(b[f.id]|=0,c[f.id]=f),d[e])return void console.log("note: "+e+" was already preloaded.");if(a[e])return f||console.log("note: "+e+" was already requested to be preloaded"),void(a[e].indexOf(f.id)>=0?console.log("note: "+e+" was already requested to be preloaded by this pxcan"):(console.log("note: "+e+" was already requested to be preloaded by a different pxcan"),a[e].push(f.id),++b[f.id]));f&&(a[e]=[f.id]),f&&++b[f.id];var h=new Image;h.onload=g,h.onerror=function(){throw new Error("Failed to load image "+e)},h.src=e},pxcan.hasImage=function(a){return!!d[a]},pxcan.image=function(a){if(!d[a])throw new Error("invalid image src: "+a);return d[a].image},pxcan.scaledImage=function(a,b){if(!d[a])throw new Error("invalid image src: "+a);if(d[a].scaledImages[b])return d[a].scaledImages[b];var c=document.createElement("canvas"),e=d[a].scaledImages[1];c.width=e.width*b,c.height=e.height*b;for(var f=c.getContext("2d"),g=e.getContext("2d").getImageData(0,0,e.width,e.height).data,h=0,i=0;i<e.height;++i)for(var j=0;j<e.width;++j)f.fillStyle="rgba("+g[h]+","+g[h+1]+","+g[h+2]+","+g[h+3]+")",f.fillRect(j*b,i*b,b,b),h+=4;return d[a].scaledImages[b]=c,c}}(),pxcan.Sheet=function(a,b,c,d){Object.defineProperty(this,"alias",{get:function(){return a}}),Object.defineProperty(this,"img",{get:function(){return pxcan.image(b)}}),Object.defineProperty(this,"src",{get:function(){return b}}),Object.defineProperty(this,"left",{get:function(){return 0}}),Object.defineProperty(this,"top",{get:function(){return 0}}),Object.defineProperty(this,"width",{get:function(){return this.img.width}}),Object.defineProperty(this,"height",{get:function(){return this.img.height}}),Object.defineProperty(this,"spriteWidth",{get:function(){return c||this.img.width}}),Object.defineProperty(this,"spriteHeight",{get:function(){return d||this.img.height}}),Object.defineProperty(this,"numCols",{get:function(){return Math.floor(this.img.width/c)}}),Object.defineProperty(this,"numRows",{get:function(){return Math.floor(this.img.height/d)}}),Object.defineProperty(this,"numSprites",{get:function(){return this.numCols*this.numRows}})},pxcan.Sheet.prototype.scaledImage=function(a){return pxcan.scaledImage(this.src,a)},pxcan.Sheet.prototype.getSprite=function(a){return new pxcan.Sprite(this,a)},pxcan.Sprite=function(a,b){if(void 0===b||null===b)throw new Error("bad frame while constructing sprite");"number"==typeof b&&b%1===0&&(b={col:b%a.numCols,row:Math.floor(b/a.numCols)});var c=void 0!==b.x?b.x:b.col?b.col*a.spriteWidth:0,d=void 0!==b.y?b.y:b.row?b.row*a.spriteHeight:0,e=void 0!==b.width?b.width:void 0!==b.col?a.spriteWidth:a.width-c,f=void 0!==b.height?b.height:void 0!==b.row?a.spriteHeight:a.height-d;Object.defineProperty(this,"sheet",{get:function(){return a}}),Object.defineProperty(this,"img",{get:function(){return a.img}}),Object.defineProperty(this,"left",{get:function(){return c}}),Object.defineProperty(this,"top",{get:function(){return d}}),Object.defineProperty(this,"width",{get:function(){return e}}),Object.defineProperty(this,"height",{get:function(){return f}})},pxcan.Sprite.prototype.scaledImage=function(a){return pxcan.scaledImage(this.sheet.src,a)},pxcan.globalSheets={},function(){function a(a,b,c,d){pxcan.preload(a),pxcan.globalSheets[b]=new pxcan.Sheet(b,a,c,d)}a("data:image/png;base64,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","pxcan-ascii",8,8),a("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABgAAAAYCAYAAADgdz34AAAAhElEQVRIie2WwQrAIAxDU/H/fzk7CdHVwdYWdjCXipQX04NqJIlCdVkbAG5q2EAh3NSQgUJCJxaeAaAm+DqONaEpp22a3mgCrrwmTVG5jIwEj8pM4HKa15WpY3AM/m3AagOrNrglyLouJp4aZF1400u4vmhZJmMa7IiPxvsojH1Y9bflAvhRIjH91XRBAAAAAElFTkSuQmCC","pxcan-border",8,8)}();